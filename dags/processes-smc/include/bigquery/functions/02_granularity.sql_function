CREATE OR REPLACE FUNCTION
  `storage-prod-olvin-com.functions.granularity_fn`( x STRING, y INT64 ) AS 
(
    CONCAT(SUBSTR(x, 0, 2*y + 3), '1', REPEAT('0', 2*(30-y) ))
);