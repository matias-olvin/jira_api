CREATE OR REPLACE FUNCTION
  `storage-prod-olvin-com.functions.point_level2token`( lat_long_point GEOGRAPHY,
    level INT64 ) AS (TO_HEX(CAST((
        SELECT
          STRING_AGG( CAST(S2_CELLIDFROMPOINT(lat_long_point,
                level => level) >> bit & 0x1 AS STRING), ''
          ORDER BY
            bit DESC)
        FROM
          UNNEST(GENERATE_ARRAY(0, 63)) AS bit ) AS BYTES FORMAT "BASE2" ) ));